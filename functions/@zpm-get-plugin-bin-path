#!/usr/bin/env zsh

local plugin_spec="$1"
local plugin_path="$2"

if [[ -z "$plugin_path" ]]; then
  return -1
fi

local candidate
if [[ "$plugin_spec" == *",path:"* ]]; then
  candidate="${plugin_path}/${${plugin_spec##*,path:}%%,*}"
  [[ -d "$candidate" ]] || return -1
  print -r -- "${candidate:a}"
  return 0
fi

candidate="${plugin_path}/bin"
if [[ -d "$candidate" ]]; then
  print -r -- "${candidate:a}"
  return 0
fi

return -1
